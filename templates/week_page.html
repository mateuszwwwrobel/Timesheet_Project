{% extends "base.html" %}

{% block content %}

    <!-- Main -->

    <section>    
        <div class="welcome-container">
            <h2>{{ user }}'s week</h2>
        </div>
        <div class="week-cart">
            <div class="day-cart">
                <h2>MONDAY</h2>
                {% for task in week_tasks %}
                {% if task.date.isoweekday == 1 %}
                    <div class="task-cart">
                        <p class="contract-number"><b></b> {{ task.date|date:"d N Y" }}</p>
                        <p class="contract-number"><b>Site name:</b> {{ task.site_name }}</p>
                        <p class="contract-number"><b>Contract number:</b> {{ task.contract_number }}</p>
                        <p class="duration"><b>Duration:</b> {{ task.duration }}h</p>
                        <p class=description><b>Description:</b> {{ task.description }}</p>
                        {% if task.car_reg %}
                        <p class="car-reg"><b>Car reg:</b> {{ task.car_reg }}</p>
                        {% else %}
                        <p class="car-reg"><b>Car reg:</b> - </p>
                        {% endif %}
                    </div>
                    <div class="delete-job-button">
                         <form action="{% url 'core:delete-task' task.id %}" method="post">
                            {% csrf_token %}
                            <input class="delete-button" type="submit" value="Delete job">
                        </form>
                    </div>
                {% endif %}
                {% endfor %}
            </div>
            <div class="day-cart">
                <h2>TUESDAY</h2>
                {% for task in week_tasks %}
                {% if task.date.isoweekday == 2 %}
                    <div class="task-cart">
                        <p class="contract-number"><b></b> {{ task.date|date:"d N Y" }}</p>
                        <p class="contract-number"><b>Site name:</b> {{ task.site_name }}</p>
                        <p class="contract-number"><b>Contract number:</b> {{ task.contract_number }}</p>
                        <p class="duration"><b>Duration:</b> {{ task.duration }}h</p>
                        <p class=description><b>Description:</b> {{ task.description }}</p>
                        {% if task.car_reg %}
                        <p class="car-reg"><b>Car reg:</b> {{ task.car_reg }}</p>
                        {% else %}
                        <p class="car-reg"><b>Car reg:</b> - </p>
                        {% endif %}
                    </div>
                    <div class="delete-job-button">
                        <form action="{% url 'core:delete-task' task.id %}" method="post">
                            {% csrf_token %}
                            <input class="delete-button" type="submit" value="Delete job">
                        </form>
                    </div>
                {% endif %}   
                {% endfor %}
            </div>
            <div class="day-cart">
                <h2>WEDNESDAY</h2>
                {% for task in week_tasks %}
                {% if task.date.isoweekday == 3 %}
                    <div class="task-cart">
                        <p class="contract-number"><b></b> {{ task.date|date:"d N Y" }}</p>
                        <p class="contract-number"><b>Site name:</b> {{ task.site_name }}</p>
                        <p class="contract-number"><b>Contract number:</b> {{ task.contract_number }}</p>
                        <p class="duration"><b>Duration:</b> {{ task.duration }}h</p>
                        <p class=description><b>Description:</b> {{ task.description }}</p>
                        {% if task.car_reg %}
                        <p class="car-reg"><b>Car reg:</b> {{ task.car_reg }}</p>
                        {% else %}
                        <p class="car-reg"><b>Car reg:</b> - </p>
                        {% endif %}
                    </div>
                    <div class="delete-job-button">
                        <form action="{% url 'core:delete-task' task.id %}" method="post">
                            {% csrf_token %}
                            <input class="delete-button" type="submit" value="Delete job">
                        </form>
                    </div>
                {% endif %}
                {% endfor %}
            </div>
            <div class="day-cart">
                <h2>THURSDAY</h2>
                {% for task in week_tasks %}
                {% if task.date.isoweekday == 4 %}
                    <div class="task-cart">
                        <p class="contract-number"><b></b> {{ task.date|date:"d N Y" }}</p>
                        <p class="contract-number"><b>Site name:</b> {{ task.site_name }}</p>
                        <p class="contract-number"><b>Contract number:</b> {{ task.contract_number }}</p>
                        <p class="duration"><b>Duration:</b> {{ task.duration }}h</p>
                        <p class=description><b>Description:</b> {{ task.description }}</p>
                        {% if task.car_reg %}
                        <p class="car-reg"><b>Car reg:</b> {{ task.car_reg }}</p>
                        {% else %}
                        <p class="car-reg"><b>Car reg:</b> - </p>
                        {% endif %}
                    </div>
                    <div class="delete-job-button">
                        <form action="{% url 'core:delete-task' task.id %}" method="post">
                            {% csrf_token %}
                            <input class="delete-button" type="submit" value="Delete job">
                        </form>
                    </div>
                {% endif %}
                {% endfor %}
            </div>
            <div class="day-cart">
                <h2>FRIDAY</h2>
                {% for task in week_tasks %}
                {% if task.date.isoweekday == 5 %}
                    <div class="task-cart">
                        <p class="contract-number"><b></b> {{ task.date|date:"d N Y" }}</p>
                        <p class="contract-number"><b>Site name:</b> {{ task.site_name }}</p>
                        <p class="contract-number"><b>Contract number:</b> {{ task.contract_number }}</p>
                        <p class="duration"><b>Duration:</b> {{ task.duration }}h</p>
                        <p class=description><b>Description:</b> {{ task.description }}</p>
                        {% if task.car_reg %}
                        <p class="car-reg"><b>Car reg:</b> {{ task.car_reg }}</p>
                        {% else %}
                        <p class="car-reg"><b>Car reg:</b> - </p>
                        {% endif %}
                    </div>
                    <div class="delete-job-button">
                        <form action="{% url 'core:delete-task' task.id %}" method="post">
                            {% csrf_token %}
                            <input class="delete-button" type="submit" value="Delete job">
                        </form>
                    </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        {% if total_hours %}
        <p>Total hours this week: {{ total_hours }}h</p>
        
        {% endif %}
        <a href="{% url 'core:reset-timesheet' %}"><button type="button" class="danger-button" onclick="return clicked();">Reset your week</button></a>
        <a href="{% url 'core:export-to-file' %}"><button type="button" class="danger-button">Generate a PDF</button></a>
        


    </section>

    <!-- END Main -->


{% endblock content %}